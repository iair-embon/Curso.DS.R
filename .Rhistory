p_x_removidos <- dbinom(df$x,n,prob = p_r_dado_y[0]) +
dbinom(df$x,n,prob = p_r_dado_y[1])
p_x_removidos
dbinom(df$x,n,prob = p_r_dado_y[0])
p_x_removidos <- dbinom(df$x,n,prob = p_r_dado_y[1]) +
dbinom(df$x,n,prob = p_r_dado_y[2])
p_x_removidos
sum(p_x_removidos)
dbinom(df$x,n,prob = p_r_dado_y[1])
sum(dbinom(df$x,n,prob = p_r_dado_y[1]))
sum(dbinom(df$x,n,prob = p_r_dado_y[2]))
p_x_removidos <- dbinom(df$x,n,prob = p_r_dado_y[1]) +
dbinom(df$x,n,prob = p_r_dado_y[2])
dbinom(df$x,n,prob = p_r_dado_y[1]) +
dbinom(df$x,n,prob = p_r_dado_y[2])
df$p_x_removidos <- dbinom(df$x,n,prob = p_r_dado_y[1]) +
dbinom(df$x,n,prob = p_r_dado_y[2])
barplot(df$p_x_removidos, names.arg = df$x, main = "Probabilidad de X=x dado Y")
df <- data.frame(x = x, p_x_0 = p_x_0)
barplot(df$p_x_0, names.arg = df$x, main = "Probabilidad de X=x dado Y=0")
library(dplyr)
df$p_x_removidos <- dbinom(df$x,n,prob = p_r_dado_y[1]) +
dbinom(df$x,n,prob = p_r_dado_y[2])
barplot(df$p_x_removidos, names.arg = df$x, main = "Probabilidad de X=x dado Y")
## ej 3
dbinom(5,n,prob = p_r_dado_y[2])
## ej 4
p_x_1 <- dbinom(x,n,prob = p_r_dado_y[2])
df$p_x_1 <-  p_x_1
df %>%
dcast(p_x_removidos ~ x, value.var = "prop")
install.packages(maditr)
install.packages("maditr")
library(maditr)
df %>%
dcast(p_x_removidos ~ x, value.var = "prop")
df %>%
dcast(y ~ x, value.var = "p_x_removidos")
library(data.table)
library(data.table)
data.table(x=x, y, p_x_removidos
data.table(x=x, y, p_x_removidos)
data.table(x=x, y, p_x_removidos)
y <- c(0,1)
P_y <- c(0.9,0.1)
# r = "remover huevo"
p_r_dado_y <- c(0.3,0.8)
n <- 8
x <- 1:8
dbinom(c(1:2),2,prob = p_r_dado_y[1])
dbinom(1,2,prob = p_r_dado_y[1])
dbinom(2,2,prob = p_r_dado_y[1])
dbinom(1,1,prob = p_r_dado_y[1])
y <- c(0,1)
P_y <- c(0.9,0.1)
y
P_y
p_r_dado_y <- c(0.3,0.8)
p_r_dado_y
dbinom(5,n,prob = p_r_dado_y[1])
dbinom(9,n,prob = p_r_dado_y[1])
dbinom(8,n,prob = p_r_dado_y[1])
dbinom(1,n,prob = p_r_dado_y[1])
dbinom(2,n,prob = p_r_dado_y[1])
dbinom(2,n,prob = p_r_dado_y[1])
dbinom(3,n,prob = p_r_dado_y[1])
dbinom(4,n,prob = p_r_dado_y[1])
dbinom(c(1:8),n,prob = p_r_dado_y[1])
sum(dbinom(c(1:8),n,prob = p_r_dado_y[1]))
p_x_0 <- dbinom(x,n,prob = p_r_dado_y[1])
p_x_0
library(ggplot2)
df <- data.frame(x = x, p_x_0 = p_x_0)
r
install.packages("dplyr")
source("D:/Windows/Descargas/Curso.DS.R/Clase 27_04/Guia_de_actividades.R", echo=TRUE)
source("D:/Windows/Descargas/Curso.DS.R/Clase 27_04/Guia_de_actividades.R", echo=TRUE)
install.packages("dplyr")
source("D:/Windows/Descargas/Curso.DS.R/Clase 27_04/Guia_de_actividades.R", echo=TRUE)
library(dplyr)
install.packages("dplyr")
library(dplyr)
install.packages("dplyr")
library(dplyr)
remove.packages("dplyr")
install.packages("dplyr")
library(dplyr)
source("D:/Windows/Descargas/Curso.DS.R/Clase 27_04/Guia_de_actividades.R", echo=TRUE)
datos <- read.csv("./Clase 27_04/depredadosclasificadas.txt", sep = " " )
p_acept <- sum(ifelse(datos$especie == 0, 1,0))/ nrow(datos)
datos %>%
filter(removidos == 5 & especie == 0) %>%
sum()/nrow(datos)
## ej 10
barplot(df$p_x_0, names.arg = df$x, main = "Probabilidad de X=x dado Y=1")
datos %>%
filter(removidos == 5 & especie == 0) %>%
sum()/nrow(datos)
datos %>%
group_by(removidos)
datos %>%
group_by(removidos) %>%
filter(especie = 0) %>%
table()
datos %>%
group_by(removidos) %>%
filter(especie == 0) %>%
table()
datos %>%
group_by(removidos) %>%
filter(especie == 0) %>%
tably()
library(janitor)
install.packages(janitor)
install.packages("janitor")
library(janitor)
datos %>%
group_by(removidos) %>%
filter(especie == 0) %>%
tably()
datos %>%
group_by(removidos) %>%
filter(especie == 0) %>%
tabyl()
datos %>%
#group_by(removidos) %>%
filter(especie == 0) %>%
tabyl(removidos)
1:8
y <- c(0,1)
P_y <- c(0.9,0.1)
# r = "remover huevo"
p_r_dado_y <- c(0.3,0.8)
n <- 8
x <- 0:8
## ej 1
dbinom(5,n,prob = p_r_dado_y[1])
p_x_0 <- dbinom(x,n,prob = p_r_dado_y[1])
library(ggplot2)
df <- data.frame(x = x, p_x_0 = p_x_0)
p_x_0
sum(p_x_0)
library(ggplot2)
df <- data.frame(x = x, p_x_0 = p_x_0)
barplot(df$p_x_0, names.arg = df$x, main = "Probabilidad de X=x dado Y=0")
dbinom(5,n,prob = p_r_dado_y[2])
## ej 4
p_x_1 <- dbinom(x,n,prob = p_r_dado_y[2])
df$p_x_1 <-  p_x_1
sum(p_x_1)
df$p_x_1 <-  p_x_1
barplot(df$p_x_1, names.arg = df$x, main = "Probabilidad de X=x dado Y=1")
dbinom(5,n,prob = p_r_dado_y[1])*p_r_dado_y[1] +
dbinom(5,n,prob = p_r_dado_y[2]) * p_r_dado_y[2]
p_x_removidos <- dbinom(df$x,n,prob = p_r_dado_y[1])*p_r_dado_y[1] +
dbinom(df$x,n,prob = p_r_dado_y[2]) * p_r_dado_y[2]
sum(p_x_removidos)
df$x
n
p_r_dado_y
dbinom(df$x,n,prob = p_r_dado_y[1])
dbinom(df$x,n,prob = p_r_dado_y[1])*p_r_dado_y[1]
sum( dbinom(df$x,n,prob = p_r_dado_y[1])*p_r_dado_y[1])
dbinom(df$x,n,prob = p_r_dado_y[1])*p_r_dado_y[1]
sum(dbinom(df$x,n,prob = p_r_dado_y[1])*p_r_dado_y[1])
dbinom(df$x,n,prob = p_r_dado_y[2]) * p_r_dado_y[2]
sum( dbinom(df$x,n,prob = p_r_dado_y[2]) * p_r_dado_y[2])
p_x_removidos <- dbinom(df$x,n,prob = p_r_dado_y[1])*p_r_dado_y[1] +
dbinom(df$x,n,prob = p_r_dado_y[2]) * p_r_dado_y[2]
tab1 <- matrix(c(df$p_x_0, df$p_x_1,p_x_removidos),nrow = 3, byrow = TRUE)
colnames(tab1) <- 1:8
rownames(tab1) <- c("p_x_0","p_x_1","p_x_removidos")
rowSums(tab1)
p_y[1]
P_y[1]
dbinom(5,n,prob = p_r_dado_y[1])*P_y[1] +
dbinom(5,n,prob = p_r_dado_y[2]) * P_y[2]
dbinom(5,n,prob = p_r_dado_y[1])*P_y[1]
dbinom(5,n,prob = p_r_dado_y[2]) * P_y[2]
p_x_removidos <- dbinom(df$x,n,prob = p_r_dado_y[1])*P_y[1] +
dbinom(df$x,n,prob = p_r_dado_y[2]) *P_y[2]
p_x_removidos
sum(p_x_removidos)
## ej 7
tab1 <- matrix(c(df$p_x_0, df$p_x_1,p_x_removidos),nrow = 3, byrow = TRUE)
colnames(tab1) <- 1:8
rownames(tab1) <- c("p_x_0","p_x_1","p_x_removidos")
rowSums(tab1)
### da algo raro, las sumas no me dan 1, deberian
## ej 8
library(dplyr)
datos <- read.csv("./Clase 27_04/depredadosclasificadas.txt", sep = " " )
p_acept <- sum(ifelse(datos$especie == 0, 1,0))/ nrow(datos)
## ej 9
datos %>%
filter(removidos == 5 & especie == 0) %>%
sum()/nrow(datos)
## ej 10
barplot(df$p_x_0, names.arg = df$x, main = "Probabilidad de X=x dado Y=1")
library(janitor)
datos %>%
#group_by(removidos) %>%
filter(especie == 0) %>%
tabyl(removidos)
datos %>%
filter(especie == 0) %>%
tabyl(removidos)
barplot(df$p_x_0, names.arg = df$x, main = "Probabilidad de X=x dado Y=1")
tab2 <- datos %>%
filter(especie == 0) %>%
tabyl(removidos)
tab2$percent
barplot(df$p_x_0, names.arg = df$x, main = "Probabilidad de X=x dado Y=0")
df$p_x_0_estimated <-  tab2$percent
tab2$percent <- append(tab2$percent,0)
tab2$percent <- append(tab2$percent,0)
tab2$percent
p_x_0_estimated <-  tab2$percent
p_x_0_estimated <- append(p_x_0_estimated,0)
p_x_0_estimated
df$p_x_0_estimated <- p_x_0_estimated
df
ggplot(df) +
geom_bar(aes(x=x,y=df$p_x_0),stat="identity")
ggplot(df) +
geom_bar(aes(x=x,y=p_x_0),stat="identity")
library(reshape2)
install.packages("reshape2")
library(reshape2)
df2 <- melt(df, id.vars = x)
df2 <- melt(df, id.vars = "x")
df2
df2 <- df %>%
select(x,p_x_0, p_x_0_estimated)   %>%
melt(df, id.vars = "x")
df %>%
select(x,p_x_0, p_x_0_estimated)
df %>%
select(x,p_x_0, p_x_0_estimated)   %>%
melt(df, id.vars = "x")
df %>%
select(x,p_x_0, p_x_0_estimated)   %>%
melt(id.vars = "x")
df2 <- df %>%
select(x,p_x_0, p_x_0_estimated)   %>%
melt(id.vars = "x")
ggplot(df2, aes(x=x, y=variable, fill= variable)) +
geom_bar(stat="identity")
ggplot(df2, aes(x=x, y=variable, fill= variable)) +
geom_bar(stat="identity", position = "dodge")
ggplot(df2, aes(x=x, y=variable, fill= variable)) +
geom_bar(position = "dodge")
ggplot(df2, aes(x=x, y=variable, fill= variable)) +
geom_bar(stat="identity",position = "dodge")
ggplot(df2, aes(x=x, y=value, fill= variable)) +
geom_bar(stat="identity",position = "dodge")
barplot(df$p_x_1, names.arg = df$x, main = "Probabilidad de X=x dado Y=0")
tab2 <- datos %>%
filter(especie == 1) %>%
tabyl(removidos)
tab2
p_x_0_estimated <-  tab2$percent
p_x_0_estimated
p_x_0_estimated <- append(c(0,0,0),p_x_0_estimated)
p_x_0_estimated
library(janitor)
tab2 <- datos %>%
filter(especie == 0) %>%
tabyl(removidos)
p_x_0_estimated <-  tab2$percent
p_x_0_estimated <- append(p_x_0_estimated,0)
df$p_x_0_estimated <- p_x_0_estimated
library(reshape2)
df2 <- df %>%
select(x,p_x_0, p_x_0_estimated)   %>%
melt(id.vars = "x")
ggplot(df2, aes(x=x, y=value, fill= variable)) +
geom_bar(stat="identity",position = "dodge")
tab3 <- datos %>%
filter(especie == 1) %>%
tabyl(removidos)
p_x_1_estimated <-  tab3$percent
p_x_1_estimated <- append(c(0,0,0),p_x_1_estimated)
df$p_x_1_estimated <- p_x_1_estimated
df3 <- df %>%
select(x,p_x_1, p_x_1_estimated)   %>%
melt(id.vars = "x")
ggplot(df3, aes(x=x, y=value, fill= variable)) +
geom_bar(stat="identity",position = "dodge")
tab4 <- matrix(c(df$p_x_0_estimated,
df$p_x_1_estimated),
nrow = 2, byrow = TRUE)
tab4
colnames(tab1) <- 0:8
rownames(tab1) <- c("p_x_0","p_x_1","p_x_removidos")
rowSums(tab1)
colnames(tab4) <- 0:8
rownames(tab4) <- c("p_x_0","p_x_1","p_x_removidos")
rowSums(tab4)
0:8
length(df$p_x_0_estimated)
matrix(c(df$p_x_0_estimated,
df$p_x_1_estimated),
nrow = 2, byrow = TRUE)
colnames(tab4) <- 0:8
rownames(tab4) <- c("p_x_0_estimated",
"p_x_1_estimated")
rowSums(tab4)
error <- regla5(datos$removidos)
regla5 <- function(x){
v <- ifelse(x => 5,1,0)
return(v)
}
regla5 <- function(x){
v <- ifelse(x => 5,1,0)
return(v)}
regla5 <- function(x){
v <- ifelse(x => 5,1,0)
return(v)
}
regla5 <- function(x){
v <- ifelse(x >= 5,1,0)
return(v)
}
error <- regla5(datos$removidos)
sum(error)
y_predicted <- regla5(datos$removidos)
error <- ifelse(y_predicted == datos$especie,0,1)
sum(error)
r <- sum(error)/nrow(datos)
r
rechazadorpar <- function(x){
v <- ifelse((x %% 2) == 0,1,0)
return(v)
}
y_predicted <- rechazadorpar(datos$removidos)
error <- ifelse(y_predicted == datos$especie,0,1)
r <- sum(error)/nrow(datos)
r
reglacorte <- function(x,t){
v <- c()
for (i in 1:length(t)) {
y_predicted <- ifelse(x >= t[i],1,0)
error <- ifelse(y_predicted == datos$especie,0,1)
r <- sum(error)/nrow(datos)
v <- c(v,r)
}
return(v)
}
r <- reglacorte(x= datos$removidos,t = c(1:8))
r
min(r)
which(min(r))
which(r == min(r))
ErrorClassTRUE <- function(g,y){
error <- ifelse(g != y,1,0)
r <- mean(error)
return(r)
}
source("D:/Windows/Descargas/Curso.DS.R/Clase del 6-05/Clase6_mayo.R", echo=TRUE)
df <- read.csv("./Descargas/alturas_identificacion_1234_n_500.csv")
wd
root <- rprojroot::is_rstudio_project
basename(getwd())
filepath <- root$find_file("./Clase del 6-05/alturas_identificacion_1234_n_500.csv")
df <- read.csv(filepath)
source("D:/Windows/Descargas/Curso.DS.R/Clase del 6-05/Clase6_mayo.R", echo=TRUE)
ClasificoVecinos <- function(X, Y, xNuevo, k=10){
indices <- order(abs(X-xNuevo))[1:k]
regla <-ifelse( mean(Y[indices]== "F") >= 0.5,1,0)
return(regla)
}
ClasificoMovil <- function(X, Y, xNuevo, h=1){
indices <- which(X >= xNuevo - h   & X <= xNuevo + h)
prop_1 <- mean(ifelse( Y[indices]=="F",1,0))
return(prop_1)
}
library(ggplot2)
library(hrbrthemes)
ggplot(df, aes(x = altura, fill = genero))+
geom_histogram()
ggplot(df, aes(x = altura, fill = genero))+
geom_histogram()+
geom_density()
ggplot(df, aes(x = altura, fill = genero))+
geom_histogram()+
geom_density(fill=genero)
ggplot(df, aes(x = altura, fill = genero))+
geom_histogram(aes(y = ..density..),
colour = 1, fill = "white")+
geom_density()
ggplot(df, aes(x = altura, fill = genero))+
geom_histogram(aes(y = ..density..))+
geom_density()
ggplot(df, aes(x = altura, fill = genero))+
geom_histogram(aes(y = ..density..))+
geom_density(alpha= 0.2)
ggplot(df, aes(x = altura, fill = genero))+
geom_histogram(aes(y = ..density..))+
geom_density(alpha= 0.4)
library(dplyr)
head(df$genero)
prop_f <- df %>%
filter(genero == "F") %>%
nrow()/nrow(df)
prop_f
prop_f <- df %>%
filter(genero == "F")
500/241
241/500
prop_f <- df %>%
filter(genero == "F") %>%
nrow()/nrow(df)
prop_m <- df %>%
filter(genero == "M") %>%
nrow()/nrow(df)
head(df$altura)
prop_f <- df %>%
filter(genero == "F") %>%
nrow()/nrow(df)
# la P(Y=1) = prop_f
## 8
prop_m <- df %>%
filter(genero == "M") %>%
nrow()/nrow(df)
prop_f
prop_m
prop_f <- df %>%
filter(genero == "F" & altura == 165) %>%
nrow()/nrow(df)
prop_f
df %>%
filter(genero == "F" & altura == 165)
prop_f <- df %>%
filter(genero == "F" && altura == 165) %>%
nrow()/nrow(df)
df %>%
filter(genero == "F" & altura == 165)
prop_f <- df %>%
filter( altura == 165) %>%
nrow()/nrow(df)
prop_f
table(df$altura)
prop_m <- df %>%
filter(genero == "M" &
altura > 164 &
altura < 166) %>%
nrow()/nrow(df)
prop_m
prop_f <- df %>%
filter(genero == "F" &
altura > 164 &
altura < 166) %>%
nrow()/nrow(df)
prop_f
prop_f <- df %>%
filter(genero == "F" &
altura > (AlguienNuevo-1) &
altura < (AlguienNuevo+1)) %>%
nrow()/nrow(df)
prop_f
prop_m <- df %>%
filter(genero == "M" &
altura > (AlguienNuevo-1) &
altura < (AlguienNuevo+1)) %>%
nrow()/nrow(df)
prop_m
rlang::last_error()
AlguienNuevo <- 165
prop_f <- df %>%
filter(genero == "F" &
altura > (AlguienNuevo-1) &
altura < (AlguienNuevo+1)) %>%
nrow()/nrow(df)
prop_m <- df %>%
filter(genero == "M" &
altura > (AlguienNuevo-1) &
altura < (AlguienNuevo+1)) %>%
nrow()/nrow(df)
prop_m
prop_f
AlguienNuevo <- 175
prop_f <- df %>%
filter(genero == "F" &
altura > (AlguienNuevo-1) &
altura < (AlguienNuevo+1)) %>%
nrow()/nrow(df)
prop_m <- df %>%
filter(genero == "M" &
altura > (AlguienNuevo-1) &
altura < (AlguienNuevo+1)) %>%
nrow()/nrow(df)
prop_f
prop_m
ClasificoGenerativo <- function(X, Y, xNuevo){
df <- data.frame(genero = Y,
altura = X)
prop_f <- df %>%
filter(genero == "F" &
altura > (xNuevo-1) &
altura < (xNuevo+1)) %>%
nrow()/nrow(df)
prop_m <- df %>%
filter(genero == "M" &
altura > (xNuevo-1) &
altura < (xNuevo+1)) %>%
nrow()/nrow(df)
regla <- ifelse(prop_f>prop_m,1,0)
return(regla)
}
ClasificoGenerativo(df$altura,df$genero,165)
ClasificoGenerativo(df$altura,df$genero,175)
